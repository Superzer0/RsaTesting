// See https://aka.ms/new-console-template for more information

using System.Security.Claims;

using ConsoleApp1;
using Newtonsoft.Json;





Console.WriteLine("");

var rsaPublicKeyPkcs1 =
    "MIIBCgKCAQEAwOhfpWqkZoTfBwt8nt9xBVpV+803Z8ueW5mkSKoFdxCFs7iDM8UdtfjA1g3GOdNa9ds2TvA/IdA8JfIQyS0psdW/BpLs2ZjZx4NyN3PU6lMXQRHmEtutJzwS5ZcemGe7RpTz2PGTijO/WmsOyAml3T7HqFYlQOUy38TQhogDpKkY43yysJJkNYSIFciM6hVH1wF6sQzkAdz8jn/9yOH+liLIx9ujwovgGbjQUsbEgYWCl/8a1cY9+iFWxkkwiDirm4q/nioYgNFWPr4v+UXDNJZKimMMv2WvSOOktnbzCc6NQq81KGwQjCpLJTDiel2+wQ9o6lVtca1UjbWSCIe23wIDAQAB";

var publicKeyNoLineBreaks =
    "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwsQMBdgSl+U7F+Fm++ylUrf3O7kfwVFdVcYdNbCwug5+XmqT0+d8Xs0IlYoDB0Pk6GdGU08gwQPio4XDSBJr/kvfN8n8TGGcqSrkOqmiih87G+lIpuRUNfxr7c9TjudnPiA/AoVqw18MKRzVf+QRWnsp9tyfswMaWexRJKq5pysnWl04iobsh6zsUQolcuPCwg+iuX41OENORHBPdC/a0QNO8AR0k00Jc2Xj7hJ3OTtJteFofmPIbCkTQH1wSGAo3VLUvN6QSBngpwrNfpPLEhMcvMyJlz6DolLk0BKsvhwj7Vu1CnXLZG282ov/7VUmVC/qI1w/5YjT1W1AROG4xQIDAQAB";

var privatePkcs8FormatNoLineBreaks = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDNRIrHwdqt5eURPC6thf9Iyj527XHgMwCI7MvRVhm2WNcap+bXkB18D/G8LYOfnznpliJzGfDGHYzIzq7tryqwKjoVVWbtwkUfut8dp7KGu41l0djb5DFeDc3s4u4vFoeMrnqlHDX9XX/SaSFHF8p6gCuToPmBDw/yMg6mlJF6oGP8SPLaa5o+OzJJxa0vjtXPWPBpwcl1v2tClUuI8By9fCGF7M7xfJ5gFfTftt+JMCLWOjotoYXkvBWDznxgNkRg+7l5yhvYu3j4exJt9/wRAO8nHek7KGRVd6fqhaZp7pqaXC5yF8QbqvcZv8WM77gkZ0uEQgy7580kNev3SkczAgMBAAECggEBAJf7Q/YbZlqTeUOFl9oK+LVgaVeM/1/M43x+N3rLkUYeCUZHQvggUHRnKcj2uhoZvrtg2ij27/sALhkQTxzVMXo2CcN59DfeO2f+6OwAGoL/ovXcpgBJuPO2rN3UOB7NQ5e6KDzP4nmyHM4h4O3Og7Cn7Zvk+FfCW0AsKATWw9BSVaMMc5I7ze6xM7uxFx9mO1flCgKuvBdo8SQwzicNJ3Bn6fUrrqPWwKtlq9rGUqQiTaCn7/t4JXaRkv7z3To4AyccyARoEgo54qVuqGu50qhILDb2rqoeHyYcac9/vaqTkDpMjJeO/dz9NK4qByK/4tgz0oDhHaOt8tYbkc1gvuECgYEA6z76wbnM9DnccwGPbonpVm4SKQEQmVs9p11B3CbRbsx+R1JQ+UdB/8GUizNkab1oB/dMtwtJDk6oNJGxDEt4an3Pvo1ZD7cQmmO+f74M+ysVSehwmOyM0M3dFtf08D9SSdJ3DjnQyF+lPnsertSFkNt2wxNBUBonzm5KN70EsD8CgYEA32CBNH1e2ndCWdXfKLfvgyVtLSBugk8yDnJTXALy+7KSjWxd9jVPrXxDoJSnefuIXV8phpO7KSc//ymUX4Z64lqzBckNLN8GUzh9G0uPw0mYj34DR1Afe/TbKcuLrtTc4DU0SfX+vYtM71JkHY26gU9HCnP6+8nuo+zm/5+drA0CgYA1ExZ8ErFdAJjuEZIMvGy6pUbPnX/jOaSlV/L9+nwR5W0wJjBCrYMEcuZSqZukB6mq8m6Kda9b3P8yLRSm03gtfokaUsWfOAw06QAXzgcbu9KnxBtzRRtYGLoi50JJ2d907FkUCpNCQeIEQL7hbu1bi0g2Juf7bItClbuE685c/QKBgEndGHxp5H6rJuab4SIOyIV+T763VbODSpMaXNQ1KXHvV6SqK9vpPwKn75je7w5YDXyKpimZGi9+ihvu/OAlkObehQoptFCdIvNL35qx/sTdxjPUwHLJXM/ZZMtKQlM6khsVnMfEL0swD+2nOfHH1t9BfsVHGrw9xsqv4KaweivVAoGAFrunRGhpPJmnTAQeEaSJSX/6wRuwQqgjOQifqhcqbbwMlxbL+4XpnUel0nlf5YUOeBkZ0CkbUD5CZfginNM7yab6IF/Ugq/4QDwGYKyYBoSa00sdnmCskKqcxEqjJuQBwRhrZXfBdrTnhtjrqGU04wkoK8yNoT2/xoSzeW6Kw00=";

var rsaPublicKeyPkcs1WithLineBreaks = @"MIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m
2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kXBeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV
44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+NnHCwe3af+PZvUOQrrI4MyrBsUtvH3OBVa
Cy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJKqE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEu
TzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN22oVTLQIDAQAB";

var rsaPublicKeyPem = @"-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m
2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kXBeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV
44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+NnHCwe3af+PZvUOQrrI4MyrBsUtvH3OBVa
Cy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJKqE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEu
TzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN22oVTLQIDAQAB
-----END RSA PUBLIC KEY-----";

// rsaPublicKey and rsaPublicKey are the same (line breaks are allowed) but PEM header is not allowed -----END RSA PUBLIC KEY-----

var pubPemFormat = @"-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR
8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kX
BeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+Nn
HCwe3af+PZvUOQrrI4MyrBsUtvH3OBVaCy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJK
qE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEuTzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN2
2oVTLQIDAQAB
-----END PUBLIC KEY-----";

// ConvertRsa.WriteToConsole(rsaPublicKeyPkcs1, ConvertRsa.FromPublicPkcs1ToPkcs8Pem);
 ConvertRsa.WriteToConsole(publicKeyNoLineBreaks, ConvertRsa.FromPublicPkcs8ToPkcs1Pem);
//ConvertRsa.WriteToConsole("./crt/self-signed-cert.cer", ConvertRsa.FromCertificatePemToPkcs8Pem);
ConvertRsa.WriteToConsole(privatePkcs8FormatNoLineBreaks, ConvertRsa.FromPrivatePkcs8ToPkcs1Pem);


var token = RsaTokens.GenerateAccessToken(new List<Claim>()
{
    new Claim("kid", "myKey")
}, "./crt/self-signed-cert.key.pem");

Console.WriteLine("Token");
Console.WriteLine(token);

var validationSuccess = RsaTokens.ValidateToken(token, "./crt/self-signed-cert.cer");
Console.WriteLine($"Validation result: {validationSuccess}");