// See https://aka.ms/new-console-template for more information

using System.Security.Claims;

using ConsoleApp1;

Console.WriteLine("");

var rsaPublicKeyPkcs1 =
    "MIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kXBeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+NnHCwe3af+PZvUOQrrI4MyrBsUtvH3OBVaCy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJKqE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEuTzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN22oVTLQIDAQAB";

var publicKeyNoLineBreaks =
    "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwsQMBdgSl+U7F+Fm++ylUrf3O7kfwVFdVcYdNbCwug5+XmqT0+d8Xs0IlYoDB0Pk6GdGU08gwQPio4XDSBJr/kvfN8n8TGGcqSrkOqmiih87G+lIpuRUNfxr7c9TjudnPiA/AoVqw18MKRzVf+QRWnsp9tyfswMaWexRJKq5pysnWl04iobsh6zsUQolcuPCwg+iuX41OENORHBPdC/a0QNO8AR0k00Jc2Xj7hJ3OTtJteFofmPIbCkTQH1wSGAo3VLUvN6QSBngpwrNfpPLEhMcvMyJlz6DolLk0BKsvhwj7Vu1CnXLZG282ov/7VUmVC/qI1w/5YjT1W1AROG4xQIDAQAB";

var privatePkcs8FormatNoLineBreaks = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDNRIrHwdqt5eURPC6thf9Iyj527XHgMwCI7MvRVhm2WNcap+bXkB18D/G8LYOfnznpliJzGfDGHYzIzq7tryqwKjoVVWbtwkUfut8dp7KGu41l0djb5DFeDc3s4u4vFoeMrnqlHDX9XX/SaSFHF8p6gCuToPmBDw/yMg6mlJF6oGP8SPLaa5o+OzJJxa0vjtXPWPBpwcl1v2tClUuI8By9fCGF7M7xfJ5gFfTftt+JMCLWOjotoYXkvBWDznxgNkRg+7l5yhvYu3j4exJt9/wRAO8nHek7KGRVd6fqhaZp7pqaXC5yF8QbqvcZv8WM77gkZ0uEQgy7580kNev3SkczAgMBAAECggEBAJf7Q/YbZlqTeUOFl9oK+LVgaVeM/1/M43x+N3rLkUYeCUZHQvggUHRnKcj2uhoZvrtg2ij27/sALhkQTxzVMXo2CcN59DfeO2f+6OwAGoL/ovXcpgBJuPO2rN3UOB7NQ5e6KDzP4nmyHM4h4O3Og7Cn7Zvk+FfCW0AsKATWw9BSVaMMc5I7ze6xM7uxFx9mO1flCgKuvBdo8SQwzicNJ3Bn6fUrrqPWwKtlq9rGUqQiTaCn7/t4JXaRkv7z3To4AyccyARoEgo54qVuqGu50qhILDb2rqoeHyYcac9/vaqTkDpMjJeO/dz9NK4qByK/4tgz0oDhHaOt8tYbkc1gvuECgYEA6z76wbnM9DnccwGPbonpVm4SKQEQmVs9p11B3CbRbsx+R1JQ+UdB/8GUizNkab1oB/dMtwtJDk6oNJGxDEt4an3Pvo1ZD7cQmmO+f74M+ysVSehwmOyM0M3dFtf08D9SSdJ3DjnQyF+lPnsertSFkNt2wxNBUBonzm5KN70EsD8CgYEA32CBNH1e2ndCWdXfKLfvgyVtLSBugk8yDnJTXALy+7KSjWxd9jVPrXxDoJSnefuIXV8phpO7KSc//ymUX4Z64lqzBckNLN8GUzh9G0uPw0mYj34DR1Afe/TbKcuLrtTc4DU0SfX+vYtM71JkHY26gU9HCnP6+8nuo+zm/5+drA0CgYA1ExZ8ErFdAJjuEZIMvGy6pUbPnX/jOaSlV/L9+nwR5W0wJjBCrYMEcuZSqZukB6mq8m6Kda9b3P8yLRSm03gtfokaUsWfOAw06QAXzgcbu9KnxBtzRRtYGLoi50JJ2d907FkUCpNCQeIEQL7hbu1bi0g2Juf7bItClbuE685c/QKBgEndGHxp5H6rJuab4SIOyIV+T763VbODSpMaXNQ1KXHvV6SqK9vpPwKn75je7w5YDXyKpimZGi9+ihvu/OAlkObehQoptFCdIvNL35qx/sTdxjPUwHLJXM/ZZMtKQlM6khsVnMfEL0swD+2nOfHH1t9BfsVHGrw9xsqv4KaweivVAoGAFrunRGhpPJmnTAQeEaSJSX/6wRuwQqgjOQifqhcqbbwMlxbL+4XpnUel0nlf5YUOeBkZ0CkbUD5CZfginNM7yab6IF/Ugq/4QDwGYKyYBoSa00sdnmCskKqcxEqjJuQBwRhrZXfBdrTnhtjrqGU04wkoK8yNoT2/xoSzeW6Kw00=";

var rsaPublicKeyPkcs1WithLineBreaks = @"MIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m
2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kXBeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV
44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+NnHCwe3af+PZvUOQrrI4MyrBsUtvH3OBVa
Cy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJKqE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEu
TzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN22oVTLQIDAQAB";

var rsaPublicKeyPem = @"-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAx2fQatW9pxi0rM3nJYZ1BQB5WOVppsiR8ivcT9MChxM4V1KijYMn2xAZ/6UhRu/m
2HKkJjVAVofmzbLlGvIVjd2lNAyMTV7srR1eQ+kwM+kXBeW5exAoB7k/KttKMkk4Gi7rMSxOxHbV
44SQS+10LzgEhJ6sAbihrXzbplTLrW+bkp1Mkl1UB+NnHCwe3af+PZvUOQrrI4MyrBsUtvH3OBVa
Cy16D4BjWBeUF3MZa002vPRZR2JpJpSCmkNTsykYFFJKqE3m+rQgLtDzwP+qvVqS7Ds5mNypgWEu
TzdPSyZJGlsC0JFxRwjhtNbcpA49dQ8H50cRCH1butN22oVTLQIDAQAB
-----END RSA PUBLIC KEY-----";

var privateKeyPkcs1 = "";

// rsaPublicKey and rsaPublicKey are the same (line breaks are allowed) but PEM header is not allowed -----END RSA PUBLIC KEY-----

var pubPemFormat = @"-----BEGIN PUBLIC KEY-----MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAvYie9Fo6llLb5Ye2qetTFhfF+mL8ArZCJpYHucjuQXnDD/sBLvKkVjaQd8AK8uICKejr92e8DRJAzWqHVWuhlB6udlpHeGz/QWi/UTA8/isIH5rwP4YZj6yHVi60CczyKQyh3ksIcq0pCguA3jhfhqhochnb7/9IYS9nps+oZ+l4KRT/wslO+ORuPYijx51RQci83wDnCzYBMDNdsbIGmxGIQedkbVMbAEuHHfbTU4yDM2uAs77HttPfpTpg2A4BSJ16SBJ8JDrdKxfyh4jBRVi1niJwtudJ6gQ8lP0jzH5ADCkq/nG+cr3NrY73VUVwpDyDNdPOH3vKd55rYJgMjaeYAToFb2EknWMOb1GjkEktVL6GgXR4+vitnZVY+tPs0aZULBuiuMViuBXazLglmWguOGgTrnHot93d5aXVsFZ11PphxJOVBgVqhTseJXkpSoGR1WRrqHtSrCC/UoH5AJEz4GhwW5zTyAM5izGdhEq4o3HoIIgiTh1M4MWnYLRGKvATz/uyP3As023LxGGPXXxO7u29SSwWBIXvo/1yM+aL6SixkzT6H+m13GRqOlBJf64ixUsVQrrhXQPS2yB+eh+PUdT1b9sx1z5NfgAzO/koEMwqz6TWIO+hQ1Z6dhmLdh9tg3e36TJ0BaRIiMdDw3jC6xX2/8qSDOhiiXPhfJUCAwEAAQ==-----END PUBLIC KEY-----";

ConvertRsa.WriteToConsole(rsaPublicKeyPkcs1, ConvertRsa.FromPublicPkcs1ToPkcs8Pem);
// ConvertRsa.WriteToConsole(pubPemFormat, ConvertRsa.FromPemToPkcs1Pem);
// ConvertRsa.WriteToConsole(rsaPublicKeyPkcs1, ConvertRsa.FromPublicPkcs1ToPkcs8Pem);
// ConvertRsa.WriteToConsole("./crt/self-signed-cert.cer", ConvertRsa.FromCertificatePemToPkcs8Pem);
// ConvertRsa.WriteToConsole(privatePkcs8FormatNoLineBreaks, ConvertRsa.FromPrivatePkcs8ToPkcs1Pem);
// ConvertRsa.WriteToConsole(privateKeyPkcs1, ConvertRsa.FromPrivatePkcs1ToPkcs8Pem);

var token = RsaTokens.GenerateAccessToken(new List<Claim>()
{
    new Claim("kid", "myKey")
}, "./crt/self-signed-cert.key.pem");

Console.WriteLine("Token");
Console.WriteLine(token);

var validationSuccess = RsaTokens.ValidateToken(token, "./crt/self-signed-cert.cer");
Console.WriteLine($"Validation result: {validationSuccess}");